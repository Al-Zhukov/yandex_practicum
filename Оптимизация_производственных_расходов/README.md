# Оптимизация производственных расходов

**Постановка задачи**
По описанию технологического процесса обработки стали необходимо предсказывать температуру стали в конце процесса. Эти данные в дальнейшем планируется использовать для оптимизации производственных расходов.

**Описание этапа обработки**

Сталь обработывается порциями около 100 тонн. Расплавленная сталь заливается в ковш и подоревается до нужной температуры графитовыми электродами. После этого проводится отбор проб, химический анализ, коррекция состава за счет добавления сплава из бункера для сыпучих материалов или проволоки. В процессе расплав продувается инерным газом, периодически подогревается электродами и перемешивается. Процесс длится, пока не будет получен необходимый химический состав и оптимальная температура плавки. После этого расплавленная сталь отправляется на следующие этапы обработки.

**Описание данных**

Данные состоят из файлов, полученных из разных источников:

- `data_arc.csv` — данные об электродах;
- `data_bulk.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time.csv` *—* данные о подаче сыпучих материалов (время);
- `data_gas.csv` — данные о продувке сплава газом;
- `data_temp.csv` — результаты измерения температуры;
- `data_wire.csv` — данные о проволочных материалах (объём);
- `data_wire_time.csv` — данные о проволочных материалах (время).

Во всех файлах столбец `key` содержит номер партии. В файлах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.

**Целевое значение метрики**

Необходимо достигнуть значения MAE < 6.

---
## Что сделано
1. Сформулирован план работы.
2. Проведена предобработка и исследовательский анализ данных, данные очищены от несодержательных и заведомых выбросов. 
3. В процессе было обнаружено, что необходим контроль данных по времени сбора, т.к. часть операций происходит до первого или после последнего измерения температуры. Также обратили внимание на то, что значения активной мощности практически пропорциональны времени нагрева и выдвинута гипотеза о том, что на самом деле это не мощность нагрева, а теплота переданная при нагреве.
4. Подготовлены признаки для обучения: первая измеренная температура, суммарное количество добавленных сыпучих и проволочных материалов, суммарное количество использованного газа, суммарное подведенное к газу количество тепла, а также общую продолжительность процесса от первого измерения до последнего, а также суммарная активная мощность для каждой партии, чтобы проверить предположение из п.3.
5. Проведена проверка на мультиколлинеарность, разбивка на тренировочную и тестовую выборки, масштабирование признаков.
6. На подготовленных данных обучены модели линейной регрессии, случайного леса, градиентного бустинга (catboost). Для ориентира построена константная модель. Для линейной регресии и градиетного бустинга проанализированы значимость признаков и проведен анализ ошибок предсказания.
7. Было принято решение отказаться от подбора гиперпараметров для градиентного бустинга, так как даже "из коробки" получилось достигнуть необходимого качества.
8. Лучше достигнутое качество на тестовой выборке: MAE = 5.94, то есть в среднем наши предсказания ошибаются на 6 градусов. Эти значения получены с помощью линейной регрессии и градиентного бустинга. При равном качестве предсказания стоит отдать предпочтение линейной регрессии, т.к. это более простая, быстрая и интерпретируемая модель.
9. Сформулированы возможные пути улучшения решения:
    1. Дополнительная настройка градиентного бустинга.
    2. Запросить дополнительную информацию у заказчика по технологическому процессу, это могло бы позволить сохранить часть данных, которые на этапе предобработки были отсеяны как подозрительные.
    3. Учитывая низкий вклад признака, связанного с продувкой газом, можно было бы от него отказаться, мы видели, что качество предсказаний при этом практически не изменяется. Отказ от этого признака позволил бы использовать значения промежуточных температур в учебной выборке для генерации дополнительных данных для обучения, что могло бы повысить качество модели, т.к. количество данных невелико.
